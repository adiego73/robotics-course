<launch>

    <param name="/use_sim_time" value="false"/>

    <node pkg="second_project" type="odometry" name="odometry_node"/>
    <node pkg="second_project" type="imu_transform" name="imu_transform"/>

    <node pkg="imu_complementary_filter" type="complementary_filter_node" name="complementary_filter_gain_node"
          output="screen">
        <param name="do_bias_estimation" value="true"/>
        <param name="do_adaptive_gain" value="true"/>
        <param name="use_mag" value="false"/>
        <param name="gain_acc" value="0.01"/>
        <param name="gain_mag" value="0.01"/>
    </node>

    <node name="ekf_node" pkg="robot_localization" type="ekf_localization_node" clear_params="true">

        <param name="frequency" value="30"/>
        <param name="sensor_timeout" value="0.1"/>
        <param name="two_d_mode" value="true"/>

        <param name="map_frame" value="map"/>
        <param name="odom_frame" value="odom"/>
        <param name="base_link_frame" value="base_link"/>
        <param name="world_frame" value="map"/>

        <param name="transform_time_offset" value="0.0"/>
        <param name="transform_timeout" value="0.0"/>

        <param name="odom0" value="/car/odometry/ackerman"/>
        <param name="imu0" value="/car/imu"/>

        <rosparam param="odom0_config">
            [true, true, true, false, false, true, false, false, false, false, false, false, false, false, false]
        </rosparam>

        <rosparam param="imu0_config">
            <!--            X ,   Y  ,   Z  , roll, pitch, yaw, X_dot, Y_dot, Z_dot, roll_dot, pitch_dot, yaw_dot .... -->
            [false, false, false, true, true, true, false, false, false, true, true, false, true, true, true]
        </rosparam>

        <param name="odom0_differential" value="false"/>
        <param name="imu0_differential" value="false"/>

        <param name="odom0_relative" value="true"/>
        <param name="imu0_relative" value="false"/>

        <param name="imu0_remove_gravitational_acceleration" value="true"/>

        <param name="print_diagnostics" value="true"/>

        <param name="odom0_queue_size" value="10"/>
        <param name="imu0_queue_size" value="10"/>

        <param name="debug" value="false"/>
        <param name="debug_out_file" value="debug_ekf_localization.txt"/>

        <!--        <param name="publish_tf" value="true" />-->

        <rosparam param="process_noise_covariance">
           [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        </rosparam>

        <rosparam param="initial_estimate_covariance">
           [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        </rosparam>

    </node>

    <!--    <node pkg="robot_localization" type="navsat_transform_node" name="navsat_transform_node">-->
    <!--        <rosparam command="load" file="$(find second_project)/params/robot_localization_params.yaml"/>-->
    <!--    </node>-->


</launch>
